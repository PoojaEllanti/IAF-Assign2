<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interactive Map of Indian Art History</title>
  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <!-- MarkerCluster CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
  />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
  />
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --panel:#111827; /* gray-900 */
      --card:#1f2937; /* gray-800 */
      --text:#e5e7eb; /* gray-200 */
      --muted:#9ca3af; /* gray-400 */
      --accent:#22d3ee; /* cyan-400 */
      --border:#374151; /* gray-700 */
      --chip:#0ea5e9; /* sky-500 */
    }
    html, body { height:100%; margin:0; background:var(--bg); color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .app { display:grid; grid-template-columns: 360px 1fr; grid-template-rows: 64px 1fr; height:100%; }
    header { grid-column: 1 / -1; display:flex; align-items:center; gap:12px; padding:12px 16px; border-bottom:1px solid var(--border); background:linear-gradient(180deg, rgba(34,211,238,0.08), transparent); }
    header h1{ font-size:1.2rem; margin:0; letter-spacing:0.2px; }
    header .badge{ padding:4px 10px; border:1px solid var(--border); border-radius:999px; color:var(--muted); font-size:12px; }

    aside { background:var(--panel); border-right:1px solid var(--border); overflow:auto; }
    .section { padding:14px 14px 0; }
    .card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:12px; }
    .controls { display:grid; gap:10px; }
    .row { display:flex; gap:8px; align-items:center; }
    .chips { display:flex; gap:6px; flex-wrap:wrap; }
    .chip { background:rgba(14,165,233,0.15); border:1px solid rgba(14,165,233,0.35); color:#cbeafe; padding:3px 8px; border-radius:999px; font-size:12px; cursor:pointer; user-select:none; }
    .chip.active{ background:rgba(34,211,238,0.18); border-color:#22d3ee; color:#a5f3fc; }
    .search { width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:#0b1220; color:var(--text); }
    .list { padding:0 14px 14px; display:grid; gap:10px; }
    .item { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:12px; cursor:pointer; transition: transform .08s ease; }
    .item:hover{ transform: translateY(-1px); border-color:#334155; }
    .item h3{ margin:0 0 6px; font-size:15px; }
    .meta { color:var(--muted); font-size:12px; display:flex; gap:6px; flex-wrap:wrap; }
    .meta .pill{ background:#0b1220; border:1px solid var(--border); padding:2px 6px; border-radius:999px; }

    #map { width:100%; height:100%; }
    .leaflet-popup-content { margin: 8px 12px; }
    .popup-title { font-weight:700; margin-bottom:6px; }
    .popup-meta{ color:#9ca3af; font-size:12px; margin-bottom:6px; }
    .popup-img{ width:100%; max-width:260px; border-radius:10px; border:1px solid var(--border); display:block; margin:8px 0; }
    .legend { position:absolute; bottom:16px; right:16px; background:var(--panel); border:1px solid var(--border); padding:10px 12px; border-radius:12px; color:var(--text); z-index:400; font-size:12px; }
    .legend-row{ display:flex; align-items:center; gap:8px; margin:4px 0; }
    .dot{ width:10px; height:10px; border-radius:999px; display:inline-block; }

    .detail { position:absolute; top:80px; right:16px; width:360px; max-height:70vh; overflow:auto; background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:12px; display:none; z-index:401; }
    .detail.open{ display:block; }
    .detail h2{ margin:4px 0 6px; font-size:18px; }
    .detail .gallery{ display:grid; grid-template-columns:1fr 1fr; gap:8px; margin:8px 0; }
    .detail img{ width:100%; border-radius:10px; border:1px solid var(--border); }
    .close-btn{ float:right; border:1px solid var(--border); background:#0b1220; color:var(--text); border-radius:8px; padding:4px 8px; cursor:pointer; }

    .small{ font-size:12px; color:var(--muted); }
    footer.note{ position:absolute; left:380px; bottom:12px; background:rgba(15,23,42,0.85); padding:6px 10px; border-radius:8px; border:1px solid var(--border); font-size:12px; }

    @media (max-width: 900px){
      .app{ grid-template-columns:1fr; grid-template-rows:64px 240px 1fr; }
      aside{ grid-row:2; }
      #map{ grid-row:3; }
      .detail{ position:fixed; left:12px; right:12px; width:auto; }
      footer.note{ left:12px; right:12px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="badge">Project</div>
      <h1>Interactive Map of Indian Art History</h1>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <span class="small">Filter by Era</span>
        <div id="eraChips" class="chips"></div>
      </div>
    </header>

    <aside>
      <div class="section">
        <div class="controls card">
          <input id="search" class="search" placeholder="Search locations, artists, styles…" />
          <div>
            <div class="small" style="margin-bottom:6px;">Styles</div>
            <div id="styleChips" class="chips"></div>
          </div>
          <div class="row" style="justify-content:space-between;">
            <button id="resetBtn" class="chip">Reset</button>
            <button id="exportBtn" class="chip">Export Data</button>
            <label class="chip" style="cursor:pointer;">
              Import JSON <input id="importFile" type="file" accept="application/json" style="display:none;" />
            </label>
          </div>
          <div class="small">Tip: Click a card to fly the map and open details.</div>
        </div>
      </div>
      <div id="list" class="list"></div>
    </aside>

    <div id="map"></div>

    <div id="detail" class="detail">
      <button class="close-btn" onclick="toggleDetail(false)">Close</button>
      <div id="detailContent"></div>
    </div>

    <div class="legend" id="legend"></div>

    <footer class="note">Use the Export button to save your dataset. Replace image URLs with your own if needed.</footer>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <!-- MarkerCluster JS -->
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

  <script>
    // === 1) Seed data — add/remove entries as needed ==========================
    // Schema reference:
    // {
    //   id: "ajanta",
    //   name: "Ajanta Caves",
    //   location: { city: "Aurangabad", state: "Maharashtra", lat: 20.5519, lng: 75.7033 },
    //   era: "Ancient", // Ancient | Medieval | Early Modern | Modern | Contemporary
    //   styles: ["Buddhist", "Fresco", "Rock-cut"],
    //   description: "…",
    //   key_artists: ["Unknown artisans"],
    //   key_artworks: ["Jataka tale murals"],
    //   imageUrls: ["https://upload.wikimedia.org/...jpg", "local/path.jpg"]
    // }

    let artSites = [
      {
        id: "ajanta",
        name: "Ajanta Caves",
        location: { city: "Aurangabad", state: "Maharashtra", lat: 20.5519, lng: 75.7033 },
        era: "Ancient",
        styles: ["Buddhist", "Fresco", "Rock-cut"],
        description: "30 rock-cut Buddhist caves (2nd c. BCE–6th c. CE) famed for murals narrating Jataka tales and refined Gupta-era painting.",
        key_artists: ["Unknown artisans"],
        key_artworks: ["Bodhisattva Padmapani", "Jataka murals"],
        imageUrls: [
          "https://tse2.mm.bing.net/th/id/OIP.KtqZh0g-8PAuU6y6R6UBpAHaEK?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "ellora",
        name: "Ellora Caves (Kailasa Temple)",
        location: { city: "Ellora", state: "Maharashtra", lat: 20.0269, lng: 75.1790 },
        era: "Ancient",
        styles: ["Hindu", "Buddhist", "Jain", "Rock-cut"],
        description: "Monumental rock-cut complex (6th–10th c.) highlighting religious pluralism; Kailasa (Cave 16) is a monolithic marvel.",
        key_artists: ["Rashtrakuta artisans"],
        key_artworks: ["Kailasa Temple"],
        imageUrls: [
          "https://tse1.mm.bing.net/th/id/OIP.725dk259r9LrEe4Jw7CEzAHaD4?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "khajuraho",
        name: "Khajuraho Group of Monuments",
        location: { city: "Chhatarpur", state: "Madhya Pradesh", lat: 24.8481, lng: 79.9334 },
        era: "Medieval",
        styles: ["Hindu", "Jain", "Nagara", "Sculpture"],
        description: "10th–12th c. temples with intricate sandstone sculptures embodying Nagara architecture and expressive figuration.",
        key_artists: ["Chandela-period ateliers"],
        key_artworks: ["Kandariya Mahadeva"],
        imageUrls: [
          "https://tse1.mm.bing.net/th/id/OIP.z21ftK9p7fJIAQbR4bQ-8QHaEl?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "tanjore",
        name: "Thanjavur (Tanjore) Painting",
        location: { city: "Thanjavur", state: "Tamil Nadu", lat: 10.7867, lng: 79.1378 },
        era: "Early Modern",
        styles: ["Tanjore", "Gold-foil", "Devotional"],
        description: "South Indian panel painting tradition (16th c. onward) featuring rich colors, gesso relief, and gold leaf, often of deities.",
        key_artists: ["Traditional workshops"],
        key_artworks: ["Krishna as child", "Saraswati panels"],
        imageUrls: [
          "https://tse1.mm.bing.net/th/id/OIP.ZJRm-6van3tTCwCMnFqr4wHaFw?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "jaipur-miniature",
        name: "Jaipur (Rajput Miniature School)",
        location: { city: "Jaipur", state: "Rajasthan", lat: 26.9124, lng: 75.7873 },
        era: "Early Modern",
        styles: ["Rajput Miniature", "Gouache", "Court art"],
        description: "Rajput miniature style thriving 17th–19th c., with vibrant palettes and romantic, courtly themes.",
        key_artists: ["Sahibram", "Kalyan Das"],
        key_artworks: ["Ragamala series", "Krishna-Lila scenes"],
        imageUrls: [
          "https://tse2.mm.bing.net/th/id/OIP.fMCDttRR3LdaFTuWRXDY3QHaFU?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "hampi",
        name: "Hampi (Vijayanagara Art)",
        location: { city: "Hampi", state: "Karnataka", lat: 15.3350, lng: 76.4600 },
        era: "Medieval",
        styles: ["Vijayanagara", "Temple architecture"],
        description: "Ruins of the Vijayanagara Empire (14th–16th c.) showcasing grand temple complexes and granite sculptures.",
        key_artists: ["Imperial workshops"],
        key_artworks: ["Stone chariots", "Virupaksha complex"],
        imageUrls: [
          "https://tse4.mm.bing.net/th/id/OIP.d7g3-JxAJhq0kI_dwOKZxwHaE8?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "santiniketan",
        name: "Santiniketan (Kala Bhavana)",
        location: { city: "Bolpur", state: "West Bengal", lat: 23.6795, lng: 87.6857 },
        era: "Modern",
        styles: ["Santiniketan School", "Contextual Modernism"],
        description: "Art school founded by Rabindranath Tagore; centre for Nandalal Bose, Benode Behari Mukherjee, and Ramkinkar Baij.",
        key_artists: ["Nandalal Bose", "Ramkinkar Baij", "Benode Behari"],
        key_artworks: ["Mural at Hindi Bhavana", "Santhal Family"],
        imageUrls: [
          "https://tse4.mm.bing.net/th/id/OIP.SD4o26YIyEi2LAdZnpH_tgHaEK?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "baroda",
        name: "MSU Baroda (Baroda School)",
        location: { city: "Vadodara", state: "Gujarat", lat: 22.3072, lng: 73.1812 },
        era: "Contemporary",
        styles: ["Baroda School", "Figurative Modernism"],
        description: "Influential post-1960s centre linked to artists like Ghulam Mohammed Sheikh and Bhupen Khakhar.",
        key_artists: ["Bhupen Khakhar", "G. M. Sheikh"],
        key_artworks: ["You Can't Please All"],
        imageUrls: [
          "https://tse4.mm.bing.net/th/id/OIP.okJdRUItRivG9lwiEJFk_gHaE8?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "pag",
        name: "Progressive Artists' Group (Bombay)",
        location: { city: "Mumbai", state: "Maharashtra", lat: 19.0760, lng: 72.8777 },
        era: "Modern",
        styles: ["Modernism", "Abstract", "Expressionism"],
        description: "Collective founded in 1947 by Souza, Husain, Raza and others—catalyzing postcolonial Indian modern art.",
        key_artists: ["F. N. Souza", "M. F. Husain", "S. H. Raza"],
        key_artworks: ["Birth (Souza)", "Bindu (Raza)"],
        imageUrls: [
          "https://tse4.mm.bing.net/th/id/OIP.X4UfHal8ZTTx6_a2qEDxqAHaFP?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "cholamandal",
        name: "Cholamandal Artists' Village",
        location: { city: "Chennai", state: "Tamil Nadu", lat: 12.8710, lng: 80.2290 },
        era: "Contemporary",
        styles: ["Artist commune", "Madras Art Movement"],
        description: "Artist-run cooperative (est. 1966) associated with K. C. S. Paniker; pivotal for modern art in South India.",
        key_artists: ["K. C. S. Paniker", "A. P. Santhanaraj"],
        key_artworks: ["Words & Symbols series"],
        imageUrls: [
          "https://tse2.mm.bing.net/th/id/OIP.uU1RmjvlMPip4LwEcwr3UAHaE8?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "kochi",
        name: "Kochi-Muziris Biennale",
        location: { city: "Kochi", state: "Kerala", lat: 9.9312, lng: 76.2673 },
        era: "Contemporary",
        styles: ["Biennale", "Installation", "New Media"],
        description: "International contemporary art biennial (since 2012) across heritage venues in Fort Kochi and Mattancherry.",
        key_artists: ["Various"],
        key_artworks: ["Site-specific installations"],
        imageUrls: [
          "https://tse3.mm.bing.net/th/id/OIP.48e_7o6o3Yp_d33IuBeRhgHaE8?pid=Api&P=0&h=180"
        ]
      },
      {
        id: "calcutta-group",
        name: "Calcutta Group",
        location: { city: "Kolkata", state: "West Bengal", lat: 22.5726, lng: 88.3639 },
        era: "Modern",
        styles: ["Modernism", "Avant-garde"],
        description: "Artist group formed in 1943 advocating a break from academic realism and nationalist revivalism.",
        key_artists: ["Paritosh Sen", "Zainul Abedin"],
        key_artworks: ["Famine sketches (Abedin)"],
        imageUrls: [
          "https://tse3.mm.bing.net/th/id/OIP.2xFMY_Xv9stxkPo95Og7vAHaFz?pid=Api&P=0&h=180"
        ]
      }
    ];

    // === 2) Dynamic facets (Eras & Styles) ====================================
    const ERAS = ["Ancient", "Medieval", "Early Modern", "Modern", "Contemporary"];
    const ERA_COLORS = {
      "Ancient": "#f59e0b",       // amber
      "Medieval": "#ef4444",      // red
      "Early Modern": "#10b981",   // emerald
      "Modern": "#3b82f6",        // blue
      "Contemporary": "#a855f7"    // violet
    };

    function uniqueStyles() {
      return Array.from(new Set(artSites.flatMap(s => s.styles))).sort();
    }

    const state = {
      era: new Set(ERAS),
      styles: new Set(), // empty = all
      search: ""
    };

    // === 3) Map setup ==========================================================
    const map = L.map('map', { zoomControl: true }).setView([22.9734, 78.6569], 5);

    const base = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const cluster = L.markerClusterGroup({ disableClusteringAtZoom: 9 });

    function markerFor(site){
      const color = ERA_COLORS[site.era] || '#22d3ee';
      const icon = L.divIcon({
        className: 'custom-marker',
        html: `<div style="background:${color}; width:14px; height:14px; border-radius:999px; border:2px solid white; box-shadow:0 0 0 2px ${color}33"></div>`
      });
      const m = L.marker([site.location.lat, site.location.lng], { icon });
      m.bindPopup(popupHtml(site));
      m.on('click', () => openDetail(site));
      return m;
    }

    function popupHtml(site){
      const img = site.imageUrls && site.imageUrls[0] ? `<img class="popup-img" src="${site.imageUrls[0]}" alt="${site.name}" />` : '';
      return `
        <div class="popup">
          <div class="popup-title">${site.name}</div>
          <div class="popup-meta">${site.location.city}, ${site.location.state} • ${site.era}</div>
          ${img}
          <div style="font-size:13px;">${site.description}</div>
        </div>
      `;
    }

    let markerIndex = new Map();

    function rebuildMarkers(){
      cluster.clearLayers();
      markerIndex.clear();
      filteredSites().forEach(site => {
        const m = markerFor(site);
        cluster.addLayer(m);
        markerIndex.set(site.id, m);
      });
      map.addLayer(cluster);
    }

    // === 4) UI: filters, search, list =========================================
    const eraChips = document.getElementById('eraChips');
    const styleChips = document.getElementById('styleChips');
    const listEl = document.getElementById('list');

    function renderEraChips(){
      eraChips.innerHTML = '';
      ERAS.forEach(era => {
        const btn = document.createElement('button');
        btn.className = 'chip' + (state.era.has(era) ? ' active' : '');
        btn.textContent = era;
        btn.onclick = () => {
          if(state.era.has(era)) state.era.delete(era); else state.era.add(era);
          btn.classList.toggle('active');
          refresh();
        };
        eraChips.appendChild(btn);
      });
    }

    function renderStyleChips(){
      styleChips.innerHTML = '';
      uniqueStyles().forEach(style => {
        const btn = document.createElement('button');
        btn.className = 'chip' + (state.styles.has(style) ? ' active' : '');
        btn.textContent = style;
        btn.onclick = () => {
          if(state.styles.has(style)) state.styles.delete(style); else state.styles.add(style);
          btn.classList.toggle('active');
          refresh();
        };
        styleChips.appendChild(btn);
      });
    }

    function filteredSites(){
      const q = state.search.trim().toLowerCase();
      return artSites.filter(s => {
        const eraOk = state.era.has(s.era);
        const styleOk = state.styles.size === 0 || s.styles.some(st => state.styles.has(st));
        const text = [s.name, s.location.city, s.location.state, s.era, ...s.styles, ...(s.key_artists||[]), ...(s.key_artworks||[])].join(' ').toLowerCase();
        const searchOk = !q || text.includes(q);
        return eraOk && styleOk && searchOk;
      });
    }

    function renderList(){
      const items = filteredSites();
      listEl.innerHTML = '';
      items.forEach(site => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `
          <h3>${site.name}</h3>
          <div class="meta">
            <span class="pill">${site.location.city}, ${site.location.state}</span>
            <span class="pill">${site.era}</span>
            ${site.styles.slice(0,3).map(st=>`<span class="pill">${st}</span>`).join('')}
          </div>
          <div class="small" style="margin-top:6px;">${site.description}</div>
        `;
        el.onclick = () => {
          const m = markerIndex.get(site.id);
          if(m){
            map.setView(m.getLatLng(), 10, { animate: true });
            m.openPopup();
          }
          openDetail(site);
        };
        listEl.appendChild(el);
      });
    }

    document.getElementById('search').addEventListener('input', e => {
      state.search = e.target.value;
      renderList();
      rebuildMarkers();
    });

    document.getElementById('resetBtn').onclick = () => {
      state.era = new Set(ERAS);
      state.styles = new Set();
      state.search = '';
      document.getElementById('search').value = '';
      renderEraChips();
      renderStyleChips();
      refresh();
    };

    // === 5) Detail panel =======================================================
    function toggleDetail(open){
      document.getElementById('detail').classList.toggle('open', open);
    }

    function openDetail(site){
      const el = document.getElementById('detailContent');
      const images = (site.imageUrls||[]).slice(0,4).map(u=>`<img src="${u}" alt="${site.name}" />`).join('');
      el.innerHTML = `
        <h2>${site.name}</h2>
        <div class="small">${site.location.city}, ${site.location.state} • ${site.era}</div>
        <div class="gallery">${images}</div>
        <p>${site.description}</p>
        ${site.key_artists?.length ? `<div><strong>Key Artists:</strong> ${site.key_artists.join(', ')}</div>` : ''}
        ${site.key_artworks?.length ? `<div><strong>Key Artworks:</strong> ${site.key_artworks.join(', ')}</div>` : ''}
        ${site.styles?.length ? `<div class="small" style="margin-top:8px;">Styles: ${site.styles.join(' • ')}</div>` : ''}
      `;
      toggleDetail(true);
    }

    // === 6) Legend =============================================================
    function renderLegend(){
      const el = document.getElementById('legend');
      el.innerHTML = '<div style="font-weight:700; margin-bottom:6px;">Eras</div>' + ERAS.map(era => `
        <div class="legend-row"><span class="dot" style="background:${ERA_COLORS[era]}"></span> ${era}</div>
      `).join('');
    }

    // === 7) Import/Export ======================================================
    const exportBtn = document.getElementById('exportBtn');
    exportBtn.onclick = () => {
      const dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(artSites, null, 2));
      const a = document.createElement('a');
      a.setAttribute('href', dataStr);
      a.setAttribute('download', 'indian_art_sites.json');
      a.click();
    };

    const importFile = document.getElementById('importFile');
    importFile.addEventListener('change', async (e) => {
      const file = e.target.files?.[0];
      if(!file) return;
      try{
        const text = await file.text();
        const json = JSON.parse(text);
        if(Array.isArray(json)){
          artSites = json;
          renderStyleChips();
          refresh();
          alert('Imported ' + json.length + ' records.');
        } else {
          alert('Invalid JSON: expected an array.');
        }
      } catch(err){
        alert('Failed to import: ' + err.message);
      }
    });

    // === 8) Refresh ============================================================
    function refresh(){
      renderList();
      rebuildMarkers();
    }

    // === 9) Init ===============================================================
    renderEraChips();
    renderStyleChips();
    renderLegend();
    refresh();
  </script>
</body>
</html>
